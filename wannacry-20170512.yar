import "hash"
import "pe"

rule wannacry_ransomware {
    meta:
        last_updated = "2022-10-21"
        author = "straysheep-dev"
        description = "WannaCry ransomware 2017-05-12"
    strings:
        $string1 = "iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea" ascii
        $string2 = "C:\\%s\\qeriuwjhrf" ascii
        $string3 = "%s -m security" ascii
        $string4 = "lhdfrgui.exe" wide
        $string5 = "115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn" ascii
        $string6 = "12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw" ascii
        $string7 = "13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94" ascii
    condition:
        hash.sha256(0, filesize) == "24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c" or
        pe.is_pe and 
        $string1 and
        $string2 and
        $string3 and
        $string4 and
        $string5 and
        $string6 and
        $string7
}
